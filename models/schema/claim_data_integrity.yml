version: 2

models:
    - name: claim_data_integrity
      config:
        database: "{{ var('output_database') }}"
        schema: "{{ var('output_schema') }}"
      description: >
        Overview of checks ran on every column in every claim input source 
        table: missing, blank, uniqueness, dates, referential integrity, 
        and valid value checks.

      columns:
        - name: table_name
          description: The name of the table

        - name: column_name
          description: The name of the column

        - name: data_type
          description: The data type of the column

        - name: table_total
          description: Total row count for the table

        - name: max_column_length
          description: Max length for values in the column

        - name: missing_values
          description: >
            Total count of missing (or null) values in the column. Additional 
            logic included for specific fields: "place_of_service_code" only 
            checked for professional claims; "bill_type_code", 
            "revenue_center_code", and "discharge_disposition_code" only 
            checked for institutional claims

        - name: missing_percentage
          description:  Percentage of missing (or null) values in the column

        - name: blank_values
          description: Total count of blank (or '') values in the column

        - name: blank_percentage
          description: Percentage of blank (or '') values in the column

        - name: unique_values
          description: Total count of unique values in the column

        - name: unique_percentage
          description: >
            Percentage of unique values in the column. Additional
            unique total logic included for "patient_id" and "claim_id".

        - name: min_date
          description: Minimum date

        - name: max_date
          description: Maximum date

        - name: date_relevance_check
          description: >
            Description of the date relevance check: "death date before 
            birth date", "discharge date before admission date", "claim end 
            date before start date", "claim line end date before start date".

        - name: date_relevance_errors
          description: Total count of rows that fail the date relevance check

        - name: date_relevance_errors_percentage
          description: Percentage of rows that fail the date relevance check

        - name: referential_integrity_check
          description: Description of the referential integrity check

        - name: referential_integrity_errors
          description: >
            Total count of rows that fail the referential integrity check

        - name: referential_integrity_errors_percentage
          description: >
            Percentage of rows that fail the referential integrity check

        - name: valid_value_check
          description: Description of the valid value check

        - name: valid_value_errors
          description: Total count of rows that fail the valid value check

        - name: valid_value_errors_percentage
          description: Percentage of rows that fail the valid value check

        - name: run_date
          description: Datetime the model was run used for snapshots
