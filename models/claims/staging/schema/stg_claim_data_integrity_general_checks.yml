version: 2

models:
    - name: stg_claim_data_integrity_general_checks
      config:
        database: "{{ var('output_database') }}"
        schema: "{{ var('output_schema') }}"
      description: >
        Loops through all claim input tables and columns and applies general 
        checks on each column.

      columns:
        - name: table_name
          description: The name of the table

        - name: column_name
          description: The name of the column

        - name: data_type
          description: The data type of the column

        - name: table_total
          description: Total row count for the table

        - name: max_column_length
          description: Max length for values in the column

        - name: missing_values
          description: >
            Total count of missing (or null) values in the column. Additional 
            logic included for specific fields: "place_of_service_code" only 
            checked for professional claims; "bill_type_code", 
            "revenue_center_code", and "discharge_disposition_code" only 
            checked for institutional claims

        - name: blank_values
          description: Total count of blank (or '') values in the column

        - name: unique_values
          description: Total count of unique values in the column
